---
import Layout from "../layouts/Layout.astro";
import DownloadButton from "../components/DownloadButton.astro";
import Section from "../components/Section.astro";
import OverrideNav from "../components/OverrideNav.astro";
import PhoneMockup from "../components/PhoneMockup.astro";
import { sections } from "../lib/data";
import { Instagram, Twitter, Github } from "@lucide/astro";
import logo from "../assets/Spot.svg?url";

// Use a few representative screenshots
const mockups = [
  "/screens/Spot_Screenshot_20260131-175721.png",
  "/screens/Spot_Screenshot_20260131-175818.png",
  "/screens/Spot_Screenshot_20260131-175827.png",
  "/screens/Spot_Screenshot_20260131-175833.png",
];
---

<Layout>
  <OverrideNav sections={sections} word="SPOT" />

  <main class="relative overflow-hidden">
    {/* Floating background elements */}
    <div
      class="fixed top-[-10%] right-[-10%] w-[50vw] h-[50vw] bg-rose-200/30 rounded-full blur-[120px] pointer-events-none z-0"
    >
    </div>
    <div
      class="fixed bottom-[-10%] left-[-10%] w-[40vw] h-[40vw] bg-fuchsia-200/30 rounded-full blur-[100px] pointer-events-none z-0"
    >
    </div>

    {/* Hero Section - Sentimental & Organic */}
    <section
      class="relative min-h-[110vh] flex flex-col items-center justify-center px-6 pt-20 pb-40 z-10"
    >
      <div class="text-center max-w-4xl mx-auto flex flex-col items-center">
        <div class="relative mb-8 group w-full">
          <div class="flex flex-col items-center">
            <img
              src={logo}
              alt="Spot Logo"
              class="w-48 md:w-64 lg:w-80 h-auto mb-6 drop-shadow-sm"
            />
            <span
              class="text-6xl md:text-8xl lg:text-9xl font-black text-rose-600 tracking-tighter drop-shadow-sm leading-none"
            >
              Momentos Reales.
            </span>
          </div>
        </div>

        <p
          class="text-2xl md:text-3xl lg:text-4xl font-medium text-rose-900/80 mb-12 max-w-2xl italic leading-snug px-4 md:px-0"
        >
          "Porque las mejores historias no se cuentan, se encuentran donde
          ocurrieron."
        </p>

        <div class="flex flex-col md:flex-row gap-6 items-center">
          <DownloadButton />
          <a
            href="#s"
            class="text-rose-600 font-bold uppercase tracking-widest text-lg hover:underline underline-offset-8 transition-all"
          >
            Explorar el sentimiento
          </a>
        </div>
      </div>

      {/* Mouse scroll indicator */}
      <div
        class="absolute bottom-10 left-1/2 -translate-x-1/2 opacity-50 animate-bounce"
      >
        <div
          class="w-8 h-12 border-2 border-rose-400 rounded-full flex justify-center pt-2"
        >
          <div class="w-1 h-3 bg-rose-400 rounded-full"></div>
        </div>
      </div>
    </section>

    {/* Feature Sections - Now integrated and centered */}
    <div class="relative z-10">
      {sections.map((section) => <Section {...section} />)}
    </div>

    {/* Gallery Section - Well distributed Showcase */}
    {/* Gallery Section - Infinite Phone Scroller */}
    <section class="py-32 overflow-hidden bg-rose-50/80 group/gallery">
      <div class="text-center mb-20 px-4">
        <h2
          class="text-4xl md:text-6xl font-black text-rose-900 mb-6 tracking-tighter"
        >
          Vistazo a la Experiencia
        </h2>
        <p
          class="text-xl md:text-2xl text-rose-800/70 max-w-2xl mx-auto italic balance"
        >
          "Desliza para explorar la interfaz de Spot."
        </p>
      </div>

      <div class="relative w-full">
        {/* Scroller Container */}
        <div
          id="gallery-scroller"
          class="flex gap-12 px-12 py-10 overflow-x-auto scrollbar-hide snap-x snap-mandatory cursor-grab active:cursor-grabbing select-none"
        >
          {
            [...mockups, ...mockups, ...mockups].map((src, i) => (
              <div class="snap-center flex-shrink-0">
                <PhoneMockup src={src} alt={`Spot Screenshot ${i}`} />
              </div>
            ))
          }
        </div>

        {/* Gradient Overlays for "Infinite" look */}
        <div
          class="absolute inset-y-0 left-0 w-32 bg-gradient-to-r from-rose-50/80 to-transparent pointer-events-none z-10 hidden md:block"
        >
        </div>
        <div
          class="absolute inset-y-0 right-0 w-32 bg-gradient-to-l from-rose-50/80 to-transparent pointer-events-none z-10 hidden md:block"
        >
        </div>
      </div>
    </section>

    <script is:inline>
      const scroller = document.getElementById("gallery-scroller");
      let isDown = false;
      let startX;
      let scrollLeft;
      let autoScrollSpeed = 0.5;
      let animationId;

      const startAutoScroll = () => {
        if (!isDown) {
          scroller.scrollLeft += autoScrollSpeed;
          // Loop seamlessly using the 3x duplication
          if (scroller.scrollLeft >= scroller.scrollWidth * (2 / 3)) {
            scroller.scrollLeft = scroller.scrollWidth * (1 / 3);
          }
        }
        animationId = requestAnimationFrame(startAutoScroll);
      };

      // Set initial position for loop
      window.addEventListener("load", () => {
        scroller.scrollLeft = scroller.scrollWidth * (1 / 3);
        startAutoScroll();
      });

      scroller.addEventListener("mousedown", (e) => {
        isDown = true;
        scroller.classList.add("active");
        startX = e.pageX - scroller.offsetLeft;
        scrollLeft = scroller.scrollLeft;
        cancelAnimationFrame(animationId);
      });

      scroller.addEventListener("mouseleave", () => {
        isDown = false;
        startAutoScroll();
      });

      scroller.addEventListener("mouseup", () => {
        isDown = false;
        startAutoScroll();
      });

      scroller.addEventListener("mousemove", (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - scroller.offsetLeft;
        const walk = (x - startX) * 1.5;
        scroller.scrollLeft = scrollLeft - walk;
      });

      // Pause on hover
      scroller.addEventListener("mouseenter", () => (autoScrollSpeed = 0));
      scroller.addEventListener("mouseleave", () => (autoScrollSpeed = 0.5));
    </script>

    {/* Final CTA / Footer */}
    <section
      class="bg-rose-100/50 py-32 px-6 text-center relative overflow-hidden"
    >
      <div class="max-w-2xl mx-auto relative z-10">
        <h2
          class="text-5xl md:text-6xl lg:text-7xl font-black text-rose-900 mb-8 tracking-tighter capitalize leading-tight"
        >
          Ancla tu primer recuerdo hoy.
        </h2>
        <DownloadButton class="mx-auto" />

        <div class="mt-24 flex flex-col items-center gap-12">
          <div class="flex gap-12 text-rose-400">
            <a href="#" class="hover:text-rose-600 transition-colors"
              ><Instagram size={40} /></a
            >
            <a href="#" class="hover:text-rose-600 transition-colors"
              ><Twitter size={40} /></a
            >
            <a href="#" class="hover:text-rose-600 transition-colors"
              ><Github size={40} /></a
            >
          </div>

          <div
            class="flex flex-col md:flex-row flex-wrap justify-center gap-x-12 gap-y-6 text-rose-800/60 font-bold uppercase tracking-widest text-sm md:text-base"
          >
            <a href="/privacy" class="hover:text-rose-600 transition-colors"
              >Privacidad</a
            >
            <a href="/terms" class="hover:text-rose-600 transition-colors"
              >TÃ©rminos</a
            >
            <a href="/versions" class="hover:text-rose-600 transition-colors"
              >Versiones</a
            >
            <span class="mt-4 md:mt-0">&copy; 2026 Spot App</span>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  main {
    background: radial-gradient(
      circle at 50% 50%,
      rgba(255, 241, 242, 1) 0%,
      rgba(255, 251, 235, 0.5) 100%
    );
  }

  h1,
  h2 {
    font-family: var(--font-headline);
  }
</style>
